# TODO: Manual Steps for `{{ name }}`

This plugin was scaffolded using `pnpm generate "copy plugin"`.

{{#if originalSourceUrl}}
**Original source:** {{ originalSourceUrl }}
{{else if originalRepositoryUrl}}
**Original repository:** {{ originalRepositoryUrl }}
{{/if}}

## 1. Configure Trusted Publishing (CRITICAL)

‚ö†Ô∏è **If trusted publishing is not configured correctly, the plugin will fail to publish from this monorepo.**

Go to the npm package access settings:

**https://www.npmjs.com/package/{{ name }}/access**

### Configure GitHub Actions as Trusted Publisher

Under **"Publishing access"**, click **"Add a trusted publisher"** and select **"GitHub Actions"**.

Fill in the fields **exactly** as shown:

| Setting              | Value         |
| -------------------- | ------------- |
| **Owner**            | `sanity-io`   |
| **Repository**       | `plugins`     |
| **Workflow**         | `release.yml` |
| **Environment name** | _(leave empty)_ |

Click **"Add trusted publisher"**.

### Configure Token Settings

Under **"Token settings"**, ensure:

- ‚úÖ **Require 2FA** for publishing is enabled
- ‚úÖ **Disallow tokens** (both granular and automation tokens)

This ensures only the GitHub Actions release workflow can publish this package using OIDC-based trusted publishing.

## 2. Update package.json Dependencies

Manually update `package.json` with any missing dependencies from the original plugin:

- `dependencies`
- `devDependencies`
- `peerDependencies`
- `exports` (if the original has custom export paths)

**Do NOT copy over:**

- `@sanity/incompatible-plugin`
- `@sanity/plugin-kit`

## 3. Copy Source Files

Copy all source files from the original plugin into `./src`:

{{#if originalRepositoryUrl}}
```bash
# Navigate to the plugin workspace folder
cd plugins/{{ name }}

# Clone the original repo and copy the src directory
git clone {{ originalRepositoryUrl }} /tmp/original-plugin
cp -r /tmp/original-plugin/src/* ./src/
rm -rf /tmp/original-plugin
```
{{else}}
```bash
# Navigate to the plugin workspace folder
cd plugins/{{ name }}

# Copy the src directory from the original plugin location
cp -r /path/to/original-plugin/src/* ./src/
```
{{/if}}

After copying, update the test studio example at:

`dev/test-studio/src/{{ dashCase pluginNamedExport }}/index.tsx`

Add any required options, schemas, or configuration needed to properly test the plugin in the test studio.

## 4. Copy and Update CHANGELOG.md

Copy the `CHANGELOG.md` from the original plugin, then update the top of the file:

**Remove this header if present:**

```md
<!-- markdownlint-disable --><!-- textlint-disable -->

# üìì Changelog

All notable changes to this project will be documented in this file. See
[Conventional Commits](https://conventionalcommits.org) for commit guidelines.
```

**Replace with:**

```md
# {{ name }}
```

## 5. Verify Setup

1. Run `pnpm install` from the monorepo root
2. Run `pnpm build` to verify the plugin builds correctly
3. Run `pnpm dev` to test in the test studio
4. Create a changeset: `pnpm changeset add`

## 6. Copy README.md (Final Step)

Copy the `README.md` from the original plugin and replace this file with it.
